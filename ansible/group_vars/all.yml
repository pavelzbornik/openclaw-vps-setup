---
# Global variables for all hosts

# System Configuration
timezone: "UTC"
locale: "en_US.UTF-8"

# OpenClaw Configuration
openclaw_user: openclaw
openclaw_group: openclaw
openclaw_home: "/home/{{ openclaw_user }}"
openclaw_install_dir: "{{ openclaw_home }}/.openclaw"
openclaw_config_dir: "{{ openclaw_install_dir }}/config"
openclaw_workspace_dir: "{{ openclaw_install_dir }}/workspace"
openclaw_logs_dir: "{{ openclaw_install_dir }}/logs"
openclaw_port: 18789
openclaw_npm_package: "openclaw"  # Official package from npm registry
openclaw_version: "latest"

# Vendor base controls (recommended approach)
# These drive the `openclaw_vendor_base` role which reuses upstream task files.
vendor_nodejs_enabled: true
vendor_tailscale_enabled: true
vendor_docker_enabled: false
vendor_firewall_enabled: false

# OpenClaw onboarding behavior
# If true, runs `openclaw onboard --install-daemon` (may manage systemd itself).
# If false, Ansible templates the systemd service + config files.
openclaw_onboard_install_daemon: false

# Node.js Configuration
nodejs_version: "22.x"  # OpenClaw requires Node >=22 (NodeSource format)

# 1Password Configuration
onepassword_cli_version: "latest"
onepassword_cli_deb_url: "https://downloads.1password.com/linux/debian/amd64/stable/1password-cli-amd64-latest.deb"
# Service account token should be set as environment variable: OP_SERVICE_ACCOUNT_TOKEN
# or encrypted with ansible-vault in a separate file

# Firewall Configuration
ufw_enabled: true
ufw_default_incoming: deny
ufw_default_outgoing: allow
ufw_logging: medium

ufw_rules:
  - { port: 22, proto: tcp, rule: limit, comment: "SSH with rate limiting" }
  - { port: 18789, proto: tcp, rule: allow, from_ip: "100.64.0.0/10", comment: "OpenClaw Gateway (Tailscale only)" }

ufw_block_ports:
  - { port: 445, proto: tcp, comment: "Block SMB" }
  - { port: 139, proto: tcp, comment: "Block NetBIOS" }

# Tailscale Configuration
tailscale_enabled: true
# Optional: auth key for unattended setup (upstream var name)
# tailscale_authkey: "tskey-auth-xxxxx"

# Security Packages
security_packages:
  - fail2ban
  - ufw
  - unattended-upgrades

# Base System Packages
base_packages:
  - git
  - curl
  - wget
  - vim
  - htop
  - nano
  - net-tools
  - ca-certificates
  - gnupg
  - lsb-release
  - apt-transport-https
  - software-properties-common
  - build-essential
  - python3-pip
  - jq

# OpenClaw Configuration Template Variables
# These reference 1Password secrets
openclaw_config:
  agent:
    model: "anthropic/claude-opus-4"
  gateway:
    bind: "0.0.0.0"
    port: "{{ openclaw_port }}"
    auth:
      mode: "token"
      token: "{{ lookup('env', 'OPENCLAW_GATEWAY_TOKEN') | default('change-me-in-production', true) }}"
  channels:
    telegram:
      enabled: false
      # token: "op://OpenClaw-Secrets/OpenClaw API Keys/TELEGRAM_BOT_TOKEN"
      dmPolicy: "pairing"
    discord:
      enabled: false
      # token: "op://OpenClaw-Secrets/OpenClaw API Keys/DISCORD_BOT_TOKEN"
      dmPolicy: "pairing"
  models:
    providers:
      anthropic:
        # apiKey: "op://OpenClaw-Secrets/OpenClaw API Keys/ANTHROPIC_API_KEY"
      openai:
        # apiKey: "op://OpenClaw-Secrets/OpenClaw API Keys/OPENAI_API_KEY"

# Environment Variables for OpenClaw Service
openclaw_env_vars:
  NODE_ENV: "production"
  # Secrets should be injected via 1Password or environment
  # ANTHROPIC_API_KEY: ""
  # OPENAI_API_KEY: ""
